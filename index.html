<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <style>
    
    </style>
    
    <script src="src/arrayND.js"></script>
    <script src="src/GlobeNoise.class.js"></script>
    <script src="src/hash.js"></script>
    <script src="src/noise.js"></script>
    <script src="src/Simplex.class.js"></script>
    <script src="src/draw.js"></script>
    
    <script>
      var gens = {
        height: new GlobeNoise(),
        heat: new GlobeNoise(),
        humidity: new GlobeNoise()
      };
      var settings = {
        width: 200,
        height: 100,
        height_octaves: 5,
        heat_octaves: 5,
        humidity_octaves: 5,
        height_bias: 0,
        heat_bias: 0,
        humidity_bias: 0,
        ice: 10,
        iceStrength: 0.5,
        iceAltitude: 0.5,
        iceAltitudeStrength: 0.5
      };
    
      function onload()
      {
        let canvas = document.getElementById("canvas");
        canvas.height = settings.height;
        canvas.width = settings.width;
        
        gens.height.generator.seed = refit(Math.random(), 0, 1, 0, 2**16, true, true);
        gens.heat.generator.seed = refit(Math.random(), 0, 1, 0, 2**16, true, true);
        gens.humidity.generator.seed = refit(Math.random(), 0, 1, 0, 2**16, true, true);
        
        draw(canvas, gens, settings);
      }
      
      function redraw()
      {
        let canvas = document.getElementById("canvas");
        canvas.height = settings.height;
        canvas.width = settings.width;
        draw(canvas, gens, settings)
      }
      
      // setting change handlers
      function changeSize(height)
      {
        settings.height=parseInt(height)
        settings.width = settings.height*2;
      }
      
      function changeSeed(which, text)
      {
        let generator = gens[which].generator;
        generator.seed = text.hashCode();
      }
      
      function updateSetting(which, value)
      {
        settings[which] = value;
      }
      
      function updateRadius(which, value)
      {
        gens[which].radius = value;
      }
    </script>
  </head>
  <body onload="onload()">
    <canvas id="canvas">
      
    </canvas>
    
    <br/>
    <button onclick="redraw()">Redraw</button>
    <br/>
    
    <label>Image height</label> <input type="number" min=5 max=1024 value=100 onchange="changeSize(this.value)"/>
    <br/>
    <small>Image width is 2*image height. Work with a small image before increasing size for export.</small>
    <br/>
    <br/>
    
    <details>
      <summary>Height settings</summary>
      <label>Seed</label> <input type="text" onchange="changeSeed('height', this.value)"/>
      <br/>
      <label>Octaves</label> <input type="number" min=1 max=8 value=5 onchange="updateSetting('height_octaves', parseInt(this.value))"/>
      <br/>
      <label>Bias</label> <input type="number" min=-2 max=2 value=0 onchange="updateSetting('height_bias', parseFloat(this.value))"/>
      <br/>
      <label>Sampling radius</label> <input type="number" min=0.1 max=20 step=0.1 value=1 onchange="updateRadius('height', parseFloat(this.value))"/>
      <br/>
      <small>Note: higher sampling radius creates smaller biomes, while smaller radius creates larger biomes</small>
      
    </details>
    <br/>
    
    <details>
      <summary>Heat settings</summary>
      <label>Seed</label> <input type="text" onchange="changeSeed('heat', this.value)"/>
      <br/>
      <label>Octaves</label> <input type="number" min=1 max=8 value=5 onchange="updateSetting('heat_octaves', parseInt(this.value))"/>
      <br/>
      <label>Bias</label> <input type="number" min=-2 max=2 value=0 onchange="updateSetting('heat_bias', parseFloat(this.value))"/>
      <br/>
      <label>Sampling radius</label> <input type="number" min=0.1 max=20 step=0.1 value=1 onchange="updateRadius('heat', parseFloat(this.value))"/>
      <br/>
      <small>Note: higher sampling radius creates smaller biomes, while smaller radius creates larger biomes</small>
      <br/>
      <label>Glacier %</label> <input type="number" min=0 max=100 value=10 onchange="updateSetting('ice', parseInt(this.value))"/>
      <br/>
      <label>Glacier strength</label> <input type="number" min=0 max=2 step=0.1 value=1 onchange="updateSetting('iceStrength', parseFloat(this.value))"/>
      <br/>
      <label>Mountain ice altitude</label> <input type="number" min=-2 max=2 step=0.1 value=0.5 onchange="updateSetting('iceAltitude', parseFloat(this.value))"/>
      <br/>
      <label>Mountain ice strength</label> <input type="number" min=0 max=2 step=0.1 value=1 onchange="updateSetting('iceAltitudeStrength', parseFloat(this.value))"/>
    </details>
    <br/>
    
    <details>
      <summary>Humidity settings</summary>
      <label>Seed</label> <input type="text" onchange="changeSeed('humidity', this.value)"/>
      <br/>
      <label>Octaves</label> <input type="number" min=1 max=8 value=5 onchange="updateSetting('humidity_octaves', parseInt(this.value))"/>
      <br/>
      <label>Bias</label> <input type="number" min=-2 max=2 value=0 onchange="updateSetting('humidity_bias', parseFloat(this.value))"/>
      <br/>
      <label>Sampling radius</label> <input type="number" min=0.1 max=20 step=0.1 value=1 onchange="updateRadius('humidity', parseFloat(this.value))"/>
      <br/>
      <small>Note: higher sampling radius creates smaller biomes, while smaller radius creates larger biomes</small>
    </details>
  </body>
</html>
